(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{24:function(t,e,n){},29:function(t,e,n){"use strict";n.r(e);var c=n(1),o=n.n(c),r=n(5),a=(n(22),n(23),n(24),n(2)),i=n(12),l=n(15),u=n.n(l),s=n(16),d=n(3),f=n(4),j=n.n(f),b=n(0),p="https://mate.academy/students-api";function h(t){return new Promise((function(e){setTimeout(e,t)}))}function m(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c={method:e};return n&&(c.body=JSON.stringify(n),c.headers={"Content-Type":"application/json; charset=UTF-8"}),h(300).then((function(){return fetch(p+t,c)})).then((function(t){if(!t.ok)throw new Error;return t.json()}))}var O,v=function(t){return m(t)},x=function(t,e){return m(t,"POST",e)},g=function(t,e){return m(t,"PATCH",e)},_=function(t){return m(t,"DELETE")},y=function(t){return v("/todos?userId=".concat(t))},N=function(t){return _("/todos/".concat(t))},k=function(t,e){return g("/todos/".concat(t),e)},C=n(32),T=n(31),w=o.a.createContext({loadDelete:[],setLoadDelete:function(){}}),E=function(t){var e=t.children,n=Object(c.useState)([]),o=Object(d.a)(n,2),r={loadDelete:o[0],setLoadDelete:o[1]};return Object(b.jsx)(w.Provider,{value:r,children:e})},D=function(t){var e=t.todo,n=t.updateTodo,o=t.clearTodo,r=t.editingTitle,a=Object(c.useState)(!1),i=Object(d.a)(a,2),l=i[0],u=i[1],s=Object(c.useState)(e.title),f=Object(d.a)(s,2),p=f[0],h=f[1],m=Object(c.useRef)(null);Object(c.useEffect)((function(){l&&m.current&&m.current.focus()}),[l]);var O=Object(c.useContext)(w).loadDelete;return Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)("div",{className:j()("todo",{completed:e.completed}),onDoubleClick:function(t){t.target!==m.current&&u(!0)},children:[Object(b.jsx)("label",{className:"todo__status-label",children:Object(b.jsx)("input",{ref:m,type:"checkbox",className:"todo__status",onChange:function(t){n&&n(t,e)},checked:e.completed})}),l?Object(b.jsx)("form",{children:Object(b.jsx)("input",{type:"text",ref:m,className:"todo__title-field",placeholder:"Empty todo will be deleted",value:p,onChange:function(t){h(t.target.value)},onKeyDown:function(t){return function(t){"Enter"===t.key?""===p.trim()&&o?(o(e),u(!1)):p===e.title?u(!1):r&&(r(e,p),u(!1)):"Escape"===t.key&&(u(!1),h(e.title))}(t)},onBlur:function(){""===p.trim()&&o?(o(e),u(!1)):p===e.title?u(!1):r&&(r(e,p),u(!1))}})}):Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("span",{className:"todo__title",children:e.title}),Object(b.jsx)("button",{type:"button",className:"todo__remove",onClick:function(){o&&o(e)},children:"\xd7"})]}),Object(b.jsxs)("div",{className:j()("modal overlay",{"is-active":O.includes(e.id)}),children:[Object(b.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(b.jsx)("div",{className:"loader"})]})]})})},A=function(t){var e=t.todos,n=t.setTodos,o=t.removeTodo,r=t.tempTodo,i=Object(c.useContext)(w).setLoadDelete,l=function(t,e){var c=t.target.checked;i([e.id]),k(e.id,Object(a.a)(Object(a.a)({},e),{},{completed:c})).then((function(){n((function(t){return t.map((function(t){return t.id===e.id?Object(a.a)(Object(a.a)({},e),{},{completed:c}):t}))}))})).catch((function(){throw new Error("Unable to update todo")})).finally((function(){return i([])}))},u=function(t){i([t.id]),N(t.id).then((function(){return o(t.id)})).catch((function(){return"Unable to delete todo"})).finally((function(){return i([])}))},s=function(t,e){i([t.id]),k(t.id,Object(a.a)(Object(a.a)({},t),{},{title:e})).then((function(){n((function(n){return n.map((function(n){return n.id===t.id?Object(a.a)(Object(a.a)({},n),{},{title:e}):n}))}))})).catch((function(){return"Unable to edit todo"})).finally((function(){return i([])}))};return Object(b.jsx)("ul",{className:"todo-list",children:Object(b.jsxs)(C.a,{children:[e.map((function(t){return Object(b.jsx)(T.a,{timeout:300,classNames:"item",children:Object(b.jsx)(D,{todo:t,updateTodo:l,clearTodo:u,editingTitle:s},t.id)},t.id)})),r&&Object(b.jsx)(T.a,{timeout:500,classNames:"temp-item",children:Object(b.jsx)(D,{todo:r},r.id)},r.id)]})})};!function(t){t.All="all",t.Active="active",t.Completed="completed"}(O||(O={}));var S=function(t){var e=t.filter,n=t.setFilter;return Object(b.jsxs)("nav",{className:"filter",children:[Object(b.jsx)("a",{href:"#/",className:j()("filter__link",{selected:e===O.All}),onClick:function(){return n(O.All)},children:"All"}),Object(b.jsx)("a",{href:"#/active",className:j()("filter__link",{selected:e===O.Active}),onClick:function(){return n(O.Active)},children:"Active"}),Object(b.jsx)("a",{href:"#/completed",className:j()("filter__link",{selected:e===O.Completed}),onClick:function(){return n(O.Completed)},children:"Completed"})]})},U=9948,F=function(){var t=Object(c.useState)([]),e=Object(d.a)(t,2),n=e[0],o=e[1],r=Object(c.useState)(null),l=Object(d.a)(r,2),f=l[0],p=l[1],h=Object(c.useState)(O.All),m=Object(d.a)(h,2),v=m[0],g=m[1],_=Object(c.useState)(""),C=Object(d.a)(_,2),T=C[0],E=C[1],D=Object(c.useState)(""),F=Object(d.a)(D,2),L=F[0],I=F[1],P=n.filter((function(t){return t.completed})),J=n.filter((function(t){return!t.completed})),B=Object(c.useContext)(w).setLoadDelete,K=function(t){o((function(e){return e.filter((function(e){return e.id!==t}))}))};Object(c.useEffect)((function(){function t(){return(t=Object(s.a)(u.a.mark((function t(){var e;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,y(U);case 3:e=t.sent,o(e),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),E("Unable to fetch todos");case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(c.useEffect)((function(){T&&setTimeout((function(){E("")}),3e3)}),[T]);var G=function(t){if("Enter"===t.key){if(t.preventDefault(),t.currentTarget.value.trim()){var e={userId:U,title:t.currentTarget.value,completed:!1},n={id:0,userId:U,title:t.currentTarget.value,completed:!1};B([n.id]),p(n),(c=e,x("/todos",c)).then((function(t){return function(t){o((function(e){return[].concat(Object(i.a)(e),[t])}))}(t)})).catch((function(){return E("Unable to add todo")})).finally((function(){p(null),B([])}))}else E("Title can't be empty");I("")}var c},H=n.filter((function(t){switch(v){case O.Active:return!t.completed;case O.Completed:return t.completed;default:return t}}));return Object(b.jsxs)("div",{className:"todoapp",children:[Object(b.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(b.jsxs)("div",{className:"todoapp__content",children:[Object(b.jsxs)("header",{className:"todoapp__header",children:[n.length>0&&Object(b.jsx)("button",{type:"button",className:j()("todoapp__toggle-all",{active:0===J.length}),onClick:function(){var t=n.map((function(t){return t.id})),e=0===J.length;B(Object(i.a)(t)),n.forEach((function(t){return k(t.id,Object(a.a)(Object(a.a)({},t),{},{completed:!e})).then((function(){o((function(t){return t.map((function(t){return Object(a.a)(Object(a.a)({},t),{},{completed:!e})}))}))})).catch((function(){throw new Error("Unable to update todos")})).finally((function(){return B([])}))}))}}),Object(b.jsx)("form",{children:Object(b.jsx)("input",{type:"text",className:"todoapp__new-todo",placeholder:"What needs to be done?",value:L,onChange:function(t){return I(t.target.value)},onKeyDown:function(t){G(t)},disabled:!!f})})]}),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("section",{className:"todoapp__main",children:Object(b.jsx)(A,{todos:H,setTodos:o,removeTodo:K,tempTodo:f})}),n.length>0&&Object(b.jsxs)("footer",{className:"todoapp__footer",children:[Object(b.jsx)("span",{className:"todo-count",children:1===J.length?"".concat(J.length," item left"):"".concat(J.length," items left")}),Object(b.jsx)(S,{filter:v,setFilter:g}),P.length>0?Object(b.jsx)("button",{type:"button",className:"todoapp__clear-completed",onClick:function(){var t=P.map((function(t){return t.id}));B(Object(i.a)(t)),t.forEach((function(t){return N(t).then((function(){return K(t)})).catch((function(){throw new Error("Clear completed error")})).finally((function(){return B([])}))}))},children:"Clear completed"}):Object(b.jsx)("button",{style:{visibility:"hidden"},type:"button",className:"todoapp__clear-completed",children:"Clear completed"})]})]})]}),Object(b.jsxs)("div",{className:j()("notification","is-danger","is-light","has-text-weight-normal",{hidden:""===T}),children:[Object(b.jsx)("button",{type:"button",className:"delete",onClick:function(){return E("")}}),T]})]})};Object(r.render)(Object(b.jsx)(E,{children:Object(b.jsx)(F,{})}),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.b4ca502e.chunk.js.map